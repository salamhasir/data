<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª - Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ¹Ù„ÙŠÙ…</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
  font-family: 'Cairo', sans-serif;
  background-color: #f0f4f8;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}
    header {
      background-color: #004e89;
      color: white;
      text-align: center;
      padding: 20px;
    }
    .container {
  display: flex;
  gap: 20px;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: space-around;
  align-items: flex-start;
  max-width: 1200px;
  width: 100%;
  background: white;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  margin-top: 20px;
}
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    canvas {
  max-width: 100%;
  margin-bottom: 20px;
}
  @media (max-width: 768px) {
  .container {
    flex-direction: column;
    align-items: center;
  }
}
</style>
</head>
<body>
  <header>
    <h1>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ¹Ù„ÙŠÙ… Ø¨Ù…Ù†Ø·Ù‚Ø© Ø¹Ø³ÙŠØ±</h1>
    <h3>Ù‚Ø³Ù… Ø§Ù„Ø£Ù…Ù† ÙˆØ§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ§Ù„Ù…Ø±Ø§ÙÙ‚</h3>
  </header>
  <div class="container">
    <h2>ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h2>
    <label for="sectorSelect">Ø§Ø®ØªØ± Ù‚Ø·Ø§Ø¹Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</label>
    <select id="sectorSelect">
      <option value="all">ÙƒÙ„ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª</option>
    </select>
    <p id="summary"></p>
    <div style="flex: 1; min-width: 300px;"><canvas id="statusChart"></canvas></div>
    <br>
    <div style="flex: 1; min-width: 300px;"><canvas id="sectorChart"></canvas></div>
    <div style="flex: 1; min-width: 300px;"><canvas id="barStatusChart"></canvas></div>
  </div>
  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbyEHr9r1KLWmf-vCShIlFU7N_q69ZFws0mTu_3AbY-l1IqJTOvwNQaL2m8IeagGpFgo/exec?action=stats";

    fetch(scriptURL)
      .then(res => res.json())
      .then(data => {
        document.getElementById("summary").textContent = `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³: ${data.total}, Ø§Ù„Ù…Ø¤ÙƒØ¯Ø©: ${data.confirmed}, Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©: ${data.modified}, Ù„Ù… ØªØ±Ø¯: ${data.pending}`;

        new Chart(document.getElementById("statusChart"), {
          type: 'doughnut',
          data: {
            labels: ['ØªÙ… Ø§Ù„ØªØ£ÙƒÙŠØ¯', 'Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø±Ø¯'],
            datasets: [{
              data: [data.confirmed, data.modified, data.pending],
              backgroundColor: ['#28a745', '#ffc107', '#dc3545']
            }]
          },
          options: {
            responsive: true,
            plugins: {
              title: {
                display: true,
                text: 'Ø­Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'
              }
            }
          }
        });

        const sectors = Object.keys(data.sectors);
        const select = document.getElementById("sectorSelect");
        sectors.forEach(sector => {
          const option = document.createElement("option");
          option.value = sector;
          option.textContent = sector;
          select.appendChild(option);
        });
        const values = Object.values(data.sectors);

        new Chart(document.getElementById("sectorChart"), {
          type: 'bar',
          data: {
            labels: sectors,
            datasets: [{
              label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø·Ø§Ø¹',
              data: values,
              backgroundColor: '#007bff'
            }]
          },
          options: {
            responsive: true,
            indexAxis: 'y',
            plugins: {
              title: {
                display: true,
                text: 'ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª'
              }
            }
          }
        });

        new Chart(document.getElementById("barStatusChart"), {
          type: 'bar',
          data: {
            labels: ['ØªÙ… Ø§Ù„ØªØ£ÙƒÙŠØ¯', 'Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø±Ø¯'],
            datasets: [{
              label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„Ø§Øª',
              data: [data.confirmed, data.modified, data.pending],
              backgroundColor: ['#28a745', '#ffc107', '#dc3545']
            }]
          },
          options: {
            responsive: true,
            plugins: {
              title: {
                display: true,
                text: 'Ù…Ø®Ø·Ø· Ø£Ø¹Ù…Ø¯Ø© Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'
              }
            }
          }
        });
      })
      .catch(err => {
        document.getElementById("summary").textContent = 'ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø§Ù„Ø§ØªØµØ§Ù„.';
        console.error('Fetch error:', err);
      });
  </script>
</body>
</html>
